{"version":3,"file":"index.js","sources":["../src/index.js"],"sourcesContent":["import React, { useRef, useState, useCallback, useEffect } from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport styles from './styles.module.css'\n\nfunction DrawingToolBox({ colors, active, onChange }) {\n  return (\n    <div className={styles.toolBoxContainer}>\n      <div className={styles.colors}>\n        {colors.map((color, key) => (\n          <button\n            key={key}\n            onClick={() => onChange(color)}\n            className={classNames(styles.color, {\n              [styles.active]: active === color\n            })}\n            style={{ backgroundColor: color }}\n          />\n        ))}\n      </div>\n    </div>\n  )\n}\n\nfunction ReactCanvasPaint(props) {\n  const canvas = useRef(null)\n  const [drawing, setDrawing] = useState(false)\n  const [position, setPosition] = useState(null)\n  const [activeColor, setActiveColor] = useState(props.colors[0])\n\n  const onDown = useCallback((event) => {\n    const coordinates = getCoordinates(event)\n    if (coordinates) {\n      setPosition(coordinates)\n      setDrawing(true)\n    }\n  }, [])\n\n  const onUp = useCallback(() => {\n    setDrawing(false)\n    setPosition(null)\n  }, [])\n\n  const getCoordinates = (event) => {\n    if (!canvas.current) {\n      return null\n    }\n\n    const x = event.pageX || event.touches[0].pageX\n    const y = event.pageY || event.touches[0].pageY\n\n    return {\n      x: x - canvas.current.offsetLeft,\n      y: y - canvas.current.offsetTop\n    }\n  }\n\n  const onMove = useCallback(\n    (event) => {\n      if (drawing) {\n        const newPosition = getCoordinates(event)\n        if (position && newPosition) {\n          drawLine(position, newPosition)\n          setPosition(newPosition)\n        }\n      }\n    },\n    [drawing, position]\n  )\n\n  const drawLine = (originalPosition, newPosition) => {\n    if (!canvas.current) {\n      return null\n    }\n\n    const context = canvas.current.getContext('2d')\n\n    if (context) {\n      context.strokeStyle = activeColor\n      context.lineJoin = 'round'\n      context.lineWidth = props.strokeWidth\n\n      context.beginPath()\n      context.moveTo(originalPosition.x, originalPosition.y)\n      context.lineTo(newPosition.x, newPosition.y)\n      context.closePath()\n\n      context.stroke()\n      handleDraw(context.getImageData(0, 0, props.width, props.height))\n    }\n  }\n\n  const handleDraw = (data) => {\n    if (typeof props.onDraw === 'function') {\n      props.onDraw(data)\n    }\n  }\n\n  useEffect(() => {\n    if (typeof props.data === 'object' && canvas.current) {\n      const context = canvas.current.getContext('2d')\n      // TODO: scale imageData\n      context.putImageData(props.data, 0, 0)\n    }\n  }, [props.data])\n\n  return (\n    <div className={styles.container}>\n      <canvas\n        ref={canvas}\n        onMouseDown={props.viewOnly ? undefined : onDown}\n        onTouchStart={props.viewOnly ? undefined : onDown}\n        onMouseUp={props.viewOnly ? undefined : onUp}\n        onTouchEnd={props.viewOnly ? undefined : onUp}\n        onMouseLeave={props.viewOnly ? undefined : onUp}\n        onMouseMove={props.viewOnly ? undefined : onMove}\n        onTouchMove={props.viewOnly ? undefined : onMove}\n        width={props.width}\n        height={props.height}\n      />\n      {!props.viewOnly && (\n        <DrawingToolBox\n          colors={props.colors}\n          active={activeColor}\n          onChange={setActiveColor}\n        />\n      )}\n    </div>\n  )\n}\n\nReactCanvasPaint.propTypes = {\n  width: PropTypes.number,\n  height: PropTypes.number,\n  viewOnly: PropTypes.bool,\n  data: PropTypes.object,\n  onDraw: PropTypes.func,\n  colors: PropTypes.arrayOf(PropTypes.string),\n  strokeWidth: PropTypes.number\n}\n\nReactCanvasPaint.defaultProps = {\n  width: 400,\n  height: 400,\n  viewOnly: false,\n  data: undefined,\n  onDraw: undefined,\n  colors: ['#7030A2', '#000000', '#0170C1', '#FE0002', '#FFFF01', '#00AF52'],\n  strokeWidth: 5\n}\n\nexport default ReactCanvasPaint\n"],"names":["DrawingToolBox","colors","active","onChange","React","styles","toolBoxContainer","map","color","key","classNames","backgroundColor","ReactCanvasPaint","props","canvas","useRef","useState","drawing","setDrawing","position","setPosition","activeColor","setActiveColor","onDown","useCallback","event","coordinates","getCoordinates","onUp","current","x","pageX","touches","y","pageY","offsetLeft","offsetTop","onMove","newPosition","drawLine","originalPosition","context","getContext","strokeStyle","lineJoin","lineWidth","strokeWidth","beginPath","moveTo","lineTo","closePath","stroke","handleDraw","getImageData","width","height","data","onDraw","useEffect","putImageData","container","viewOnly","undefined","propTypes","PropTypes","number","bool","object","func","arrayOf","string","defaultProps"],"mappings":"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"}